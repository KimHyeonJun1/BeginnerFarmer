<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.farm.manage.ManageMapper">

 <!-- 선택한 유저의 작물정보 조회 --> 
<!-- <select id="getOneManage" resultType="manage"> -->
<!-- select * from userplant -->
<!-- </select> -->


<!-- userplant에서 유저아이디 등록되어 있는 갯수 조회 -->
<select id="countOfUserPlant" resultType="Integer">
select count(*) from userplant 
where userid_log = #{userid_log}
</select>



<!-- 전체작물목록조회 -->
<select id="getListOfManage" resultType="manage">
select * from plant <if test="userid_log != null">where plant_id not in( select plantid_log from userplant where userid_log = #{userid_log})</if>
</select>

<!-- 작물 등록 -->
<insert id="registerUserPlant" >
insert into userplant (userid_log, plantid_log)
values ( #{userid_log}, #{plantid_log} )
</insert>

<!-- 자신이 등록한 작물 정보 조회 -->
<select id="getUserPlants" resultType="manage">
SELECT p.*
    FROM Plant p
    INNER JOIN userplant u ON p.plant_id = u.plantid_log
    WHERE u.userid_log = #{userid_log}
</select>

<!-- 등록된 작물정보삭제 -->
<delete id ="deleteUserPlant">
DELETE FROM userplant WHERE userid_log = #{userid_log} AND plantid_log = #{plantid_log}
</delete>


</mapper>